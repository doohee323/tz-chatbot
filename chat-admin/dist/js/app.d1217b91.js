(function(){"use strict";var t={6948:function(t,e,s){var a=s(2856),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("header",{staticClass:"app-header"},[e("div",{staticClass:"nav-left"},[e("router-link",{staticClass:"logo",attrs:{to:"/"}},[t._v(t._s(t.$t("menu.appName")))]),t.isAdminArea?[e("router-link",{staticClass:"nav-link",attrs:{to:"/admin/systems"}},[t._v(t._s(t.$t("menu.chatManage")))]),e("router-link",{staticClass:"nav-link",attrs:{to:"/admin"}},[t._v(t._s(t.$t("menu.chatList")))])]:t._e()],2),e("nav",{staticClass:"nav-right"},[e("div",{staticClass:"lang-dropdown"},[e("button",{staticClass:"btn-lang",attrs:{type:"button"},on:{click:function(e){t.showLangMenu=!t.showLangMenu}}},[t._v(" "+t._s(t.currentLangLabel)+" ▼ ")]),t.showLangMenu?e("div",{staticClass:"lang-menu",on:{click:function(e){t.showLangMenu=!1}}},[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$changeLanguage("ko")}}},[t._v("한국어")]),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$changeLanguage("en")}}},[t._v("English")])]):t._e()]),t.isAdminArea?[t.adminUsername?e("router-link",{staticClass:"admin-username",attrs:{to:"/admin/profile"}},[t._v(t._s(t.adminUsername))]):t._e(),e("button",{staticClass:"btn-logout",attrs:{type:"button"},on:{click:t.logout}},[t._v(t._s(t.$t("menu.logout")))])]:[e("router-link",{staticClass:"nav-link",attrs:{to:"/about"}},[t._v(t._s(t.$t("menu.about")))]),e("router-link",{staticClass:"nav-link",attrs:{to:"/register"}},[t._v(t._s(t.$t("menu.register")))]),e("router-link",{staticClass:"nav-link",attrs:{to:"/login"}},[t._v(t._s(t.$t("menu.login")))])]],2)]),e("main",{staticClass:"app-main"},[e("router-view")],1)])},o=[];s(9112),s(4979);const r="admin_token";function n(t){if(!t)return null;try{const e=t.split(".");if(3!==e.length)return null;const s=JSON.parse(atob(e[1].replace(/-/g,"+").replace(/_/g,"/")));return s.sub||null}catch{return null}}var l={name:"App",data(){return{showLangMenu:!1}},computed:{currentLangLabel(){return"ko"===this.$i18n.locale?"한국어":"English"},isAdminArea(){return this.$route.path.startsWith("/admin")},adminUsername(){return this.$route.path,n(localStorage.getItem(r))}},methods:{logout(){localStorage.removeItem(r),this.$router.replace("/login")}}},d=l,c=s(1656),m=(0,c.A)(d,i,o,!1,null,null,null),p=m.exports,h=s(1594),u=function(){var t=this,e=t._self._c;return e("div",{staticClass:"intro wrap"},[e("p",{staticClass:"tagline"},[t._v("Unified chat API in front of Dify. Part of the tz-chatbot stack.")]),t._m(0),t._m(1),e("h2",{staticClass:"section-title"},[t._v("1. Workflow")]),e("p",{staticClass:"tagline tagline-sm"},[t._v("Check out this repo, use sample apps (DrillQuiz / CoinTutor) as reference to register and apply your app.")]),t._m(2),e("div",{staticClass:"links"},[e("router-link",{staticClass:"link-btn",attrs:{to:"/about"}},[t._v(t._s(t.$t("intro.aboutDetail")))]),e("a",{attrs:{href:"https://github.com/doohee323/tz-chatbot",target:"_blank",rel:"noopener"}},[t._v("GitHub source")]),e("a",{attrs:{href:t.apiBase+"/docs",target:"_blank",rel:"noopener"}},[t._v("API docs (OpenAPI)")]),e("router-link",{attrs:{to:"/chat"}},[t._v("Chat page")])],1)])},g=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("h2",[t._v("What this is")]),e("p",[t._v(" This service is the "),e("strong",[t._v("TZ-Chat Gateway")]),t._v(": a single API and chat UI for multiple apps (e.g. DrillQuiz, CoinTutor). It sits in front of "),e("a",{staticClass:"link",attrs:{href:"https://dify.ai",target:"_blank",rel:"noopener"}},[t._v("Dify")]),t._v(", manages users and conversations, and can sync chat history to its own database for support and analytics. Sample integration: "),e("a",{staticClass:"link",attrs:{href:"https://devops.drillquiz.com/",target:"_blank",rel:"noopener"}},[t._v("devops.drillquiz.com")]),t._v(" (DrillQuiz). ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("h2",[t._v("Project: tz-chatbot")]),e("p",[t._v(" The full stack runs on Kubernetes: "),e("strong",[t._v("MinIO")]),t._v(" (object store), "),e("strong",[t._v("Qdrant")]),t._v(" (vector DB), "),e("strong",[t._v("RAG backends")]),t._v(" (CoinTutor / DrillQuiz), "),e("strong",[t._v("Dify")]),t._v(" (chatbots), and this "),e("strong",[t._v("TZ-Chat Gateway")]),t._v(". RAG ingestion runs on a schedule; Dify apps call the RAG backends as tools. ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"diagram"},[e("div",{staticClass:"diagram-title"},[t._v("Flow: add your app, then use chat")]),e("div",{staticClass:"flow-row"},[e("span",{staticClass:"flow-step"},[t._v("1. Check out this code")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("2. Register your app (reference: DrillQuiz / CoinTutor)")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("3. Get token & open chat page")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("4. Chat")])])])}];const f={NODE_ENV:"production",VUE_APP_CHAT_GATEWAY_URL:"https://chat.BASE_DOMAIN_PLACEHOLDER",VUE_APP_ENVIRONMENT:"production",BASE_URL:"/"}.VUE_APP_API_BASE||"",v="https://chat.BASE_DOMAIN_PLACEHOLDER".replace(/\/$/,""),_=v&&!v.includes("PLACEHOLDER"),y=_?v:(()=>{if("undefined"!==typeof window&&window.location?.hostname?.includes("chat-admin")){const t=window.location.hostname.replace(/^chat-admin/,"chat");return`${window.location.protocol}//${t}`}return""})(),w="undefined"===typeof window||f?f:window.location.origin,C=y;var b={name:"Intro",data(){return{apiBase:w}}},k=b,S=(0,c.A)(k,u,g,!1,null,"24384ca0",null),I=S.exports,$=function(){var t=this,e=t._self._c;return e("div",{staticClass:"about wrap"},[e("h1",[t._v("TZ-Chat Gateway")]),e("p",{staticClass:"tagline"},[t._v("Unified chat API in front of Dify. Part of the tz-chatbot stack.")]),t._m(0),t._m(1),e("h2",{staticClass:"section-title"},[t._v("1. Workflow")]),e("p",{staticClass:"tagline-sm"},[t._v("Check out this repo, use sample apps (DrillQuiz / CoinTutor) as reference to register and apply your app.")]),t._m(2),e("h2",{staticClass:"section-title"},[t._v("2. How the app operates")]),e("p",{staticClass:"tagline-sm"},[t._v("Request-to-response processing order")]),t._m(3),e("h2",{staticClass:"section-title"},[t._v("3. Architecture")]),e("p",{staticClass:"tagline-sm"},[t._v("tz-chatbot stack components")]),t._m(4),e("h2",{staticClass:"section-title"},[t._v("4. Apply to your project")]),e("p",{staticClass:"tagline-sm"},[t._v("Steps to add chat to an existing project (e.g. Vue app)")]),t._m(5),e("div",{staticClass:"links"},[e("a",{attrs:{href:"https://github.com/doohee323/tz-chatbot",target:"_blank",rel:"noopener"}},[t._v("GitHub source")]),e("a",{attrs:{href:"https://devops.drillquiz.com/",target:"_blank",rel:"noopener"}},[t._v("Sample site (DrillQuiz)")]),e("a",{attrs:{href:t.apiBase+"/docs",target:"_blank",rel:"noopener"}},[t._v("API docs (OpenAPI)")]),e("router-link",{attrs:{to:"/chat"}},[t._v("Chat page")]),t.apiBase?e("a",{attrs:{href:t.apiBase+"/cache",target:"_blank",rel:"noopener"}},[t._v("Cache / history (API key required)")]):t._e()],1),t._m(6)])},A=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("h2",[t._v("What this is")]),e("p",[t._v(" This service is the "),e("strong",[t._v("TZ-Chat Gateway")]),t._v(": a single API and chat UI for multiple apps (e.g. DrillQuiz, CoinTutor). It sits in front of "),e("a",{staticClass:"link",attrs:{href:"https://dify.ai",target:"_blank",rel:"noopener"}},[t._v("Dify")]),t._v(", manages users and conversations, and can sync chat history to its own database for support and analytics. Sample integration: "),e("a",{staticClass:"link",attrs:{href:"https://devops.drillquiz.com/",target:"_blank",rel:"noopener"}},[t._v("devops.drillquiz.com")]),t._v(" (DrillQuiz). ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("h2",[t._v("Project: tz-chatbot")]),e("p",[t._v(" The full stack runs on Kubernetes: "),e("strong",[t._v("MinIO")]),t._v(" (object store), "),e("strong",[t._v("Qdrant")]),t._v(" (vector DB), "),e("strong",[t._v("RAG backends")]),t._v(" (CoinTutor / DrillQuiz), "),e("strong",[t._v("Dify")]),t._v(" (chatbots), and this "),e("strong",[t._v("TZ-Chat Gateway")]),t._v(". RAG ingestion runs on a schedule; Dify apps call the RAG backends as tools. ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"diagram"},[e("div",{staticClass:"diagram-title"},[t._v("Flow: add your app, then use chat")]),e("div",{staticClass:"flow-row"},[e("span",{staticClass:"flow-step"},[t._v("1. Check out this code")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("2. Register your app (reference: DrillQuiz / CoinTutor)")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("3. Get token & open chat page")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("4. Chat")])]),e("div",{staticClass:"flow-row flow-detail"},[e("span",{staticClass:"flow-step"},[t._v("You add and register your app; you do not choose from existing apps. Token: issued after your app's login, or call "),e("code",[t._v("/v1/chat-token")]),t._v(" with API Key.")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"diagram"},[e("div",{staticClass:"diagram-title"},[t._v("Request → response sequence")]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("Client")]),e("span",{staticClass:"seq-box"},[t._v("Send message from chat UI (JWT or API Key)")])]),e("div",{staticClass:"arch-arrow-row"},[t._v("↓")]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("TZ-Chat Gateway")]),e("span",{staticClass:"seq-box"},[t._v("Validate JWT/API Key → sync conversation/messages to DB → proxy to Dify API")])]),e("div",{staticClass:"arch-arrow-row"},[t._v("↓")]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("Dify")]),e("span",{staticClass:"seq-box"},[t._v("Run DrillQuiz or CoinTutor app (calls RAG tool when needed)")])]),e("div",{staticClass:"arch-arrow-row"},[t._v("↓")]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("RAG")]),e("span",{staticClass:"seq-box"},[t._v("Qdrant + RAG Backend search → return results to Dify (required)")])]),e("div",{staticClass:"arch-arrow-row"},[t._v("↓")]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("Response")]),e("span",{staticClass:"seq-box"},[t._v("Dify → TZ-Chat Gateway → client (streaming or normal response)")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"diagram"},[e("div",{staticClass:"diagram-title"},[t._v("Components and relationships")]),e("div",{staticClass:"arch-arrow-row"},[t._v("Ingress (TLS / routing)")]),e("div",{staticClass:"arch-arrow-row"},[t._v("↓")]),e("div",{staticClass:"arch-grid"},[e("div",{staticClass:"arch-box entry"},[t._v("TZ-Chat Gateway"),e("br"),e("small",[t._v("(FastAPI)")])]),e("div",{staticClass:"arch-box gw"},[t._v("Dify"),e("br"),e("small",[t._v("DrillQuiz / CoinTutor")])]),e("div",{staticClass:"arch-box app"},[t._v("RAG Backend"),e("br"),e("small",[t._v("CoinTutor, DrillQuiz")])]),e("div",{staticClass:"arch-box data"},[t._v("Qdrant"),e("br"),e("small",[t._v("vector DB")])]),e("div",{staticClass:"arch-box data"},[t._v("MinIO"),e("br"),e("small",[t._v("object store")])])]),e("p",{staticClass:"arch-note"},[t._v("TZ-Chat Gateway: auth, conversation management, Dify proxy. Dify: calls RAG as tool. RAG: MinIO docs + Qdrant vector search.")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"diagram"},[e("div",{staticClass:"diagram-title"},[t._v("Integration order")]),e("div",{staticClass:"flow-row"},[e("span",{staticClass:"flow-step"},[t._v("1. Deploy TZ-Chat Gateway")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("2. Configure env")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("3. Backend token")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("4. Frontend widget")]),e("span",{staticClass:"flow-arrow"},[t._v("→")]),e("span",{staticClass:"flow-step"},[t._v("5. CORS & CSP")])]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("1. Deploy")]),e("span",{staticClass:"seq-box"},[t._v("Run TZ-Chat Gateway on server (Docker/K8s or "),e("code",[t._v("./gateway.sh")]),t._v("). Set JWT secret, Dify API key, "),e("code",[t._v("CHAT_GATEWAY_API_KEY")]),t._v(" in "),e("code",[t._v(".env")]),t._v(".")])]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("2. Env")]),e("span",{staticClass:"seq-box"},[e("code",[t._v("CHAT_GATEWAY_JWT_SECRET")]),t._v(", "),e("code",[t._v("CHAT_GATEWAY_API_KEY")]),t._v(", "),e("code",[t._v("DIFY_*_API_KEY")]),t._v(". See "),e("code",[t._v(".env.example")]),t._v(", "),e("code",[t._v("scripts/gen-env-values.sh")]),t._v(".")])]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("3. Backend")]),e("span",{staticClass:"seq-box"},[t._v("Issue JWT for logged-in users from your backend, or have frontend call "),e("code",[t._v("GET /v1/chat-token?system_id=...&user_id=...")]),t._v(" with "),e("code",[t._v("X-API-Key")]),t._v(".")])]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("4. Frontend")]),e("span",{staticClass:"seq-box"},[t._v("Copy "),e("code",[t._v("sample/ChatWidget.vue")]),t._v(" → wire "),e("code",[t._v("authService")]),t._v(" (getUserSync, subscribe) → add "),e("code",[t._v("<ChatWidget />")]),t._v(" in App.vue. Set "),e("code",[t._v("VUE_APP_CHAT_GATEWAY_URL")]),t._v(", "),e("code",[t._v("VUE_APP_CHAT_GATEWAY_API_KEY")]),t._v(".")])]),e("div",{staticClass:"seq-row"},[e("span",{staticClass:"seq-label"},[t._v("5. CORS·CSP")]),e("span",{staticClass:"seq-box"},[t._v("Allow your project domain in TZ-Chat Gateway ("),e("code",[t._v("ALLOWED_CHAT_TOKEN_ORIGINS")]),t._v("). If the app has CSP, add TZ-Chat Gateway URL to "),e("code",[t._v("connect-src")]),t._v(" and "),e("code",[t._v("frame-src")]),t._v(".")])]),e("p",{staticClass:"arch-note"},[t._v(" Full steps: "),e("a",{staticClass:"link",attrs:{href:"https://github.com/doohee323/tz-chatbot/blob/main/chat-gateway/sample/INTEGRATION.md",target:"_blank",rel:"noopener"}},[t._v("sample/INTEGRATION.md")])])])},function(){var t=this,e=t._self._c;return e("p",{staticClass:"footer"},[t._v(" Chat page requires a valid JWT ("),e("code",[t._v("?token=...")]),t._v("). Use the chat from DrillQuiz or CoinTutor, or obtain a token via "),e("code",[t._v("GET /v1/chat-token")]),t._v(" with "),e("code",[t._v("X-API-Key")]),t._v(". ")])}],P={name:"About",data(){return{apiBase:w}}},T=P,D=(0,c.A)(T,$,A,!1,null,"ef705832",null),E=D.exports,R=function(){var t=this,e=t._self._c;return t.init?e("div",{staticClass:"chat-page",class:{"chat-page--modal":t.inModal}},[t.init.embed?t._e():e("div",{staticClass:"header"},[e("span",[t._v("System: "+t._s(t.init.systemId)+" · User: "+t._s(t.init.userId))])]),e("div",{staticClass:"layout",class:{"layout--embed":t.init.embed}},[t.init.embed?t._e():e("aside",{staticClass:"sidebar"},[e("h3",[t._v("Conversations")]),e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.newConversation}},[t._v(t._s(t.t.sendNew))]),e("ul",{staticClass:"conv-list"},t._l(t.conversations,function(s){return e("li",{key:s.id,class:{active:s.id===t.currentConversationId},on:{click:function(e){return t.selectConversation(s.id)}}},[e("span",{staticClass:"conv-name"},[t._v(t._s(s.name||s.id||"(Conversation)"))]),e("button",{staticClass:"btn-del-conv",attrs:{type:"button",title:"삭제"},on:{click:function(e){return e.stopPropagation(),t.deleteConversation(s.id)}}},[t._v("×")])])}),0)]),e("main",{staticClass:"main"},[e("div",{ref:"messages",staticClass:"messages"},[e("p",{directives:[{name:"show",rawName:"v-show",value:0===t.messages.length,expression:"messages.length === 0"}],staticClass:"empty-state"},[t._v(t._s(t.emptyText))]),t._l(t.messages,function(s,a){return e("div",{key:a,class:["msg","msg-"+s.role]},[e("div",{staticClass:"msg-role"},[t._v(t._s("user"===s.role?t.t.me:t.t.bot))]),e("div",{domProps:{innerHTML:t._s(t.escapeHtml(s.content))}})])})],2),e("div",{staticClass:"error"},[t._v(t._s(t.error))]),e("div",{staticClass:"input-row"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],attrs:{type:"text",placeholder:t.t.placeholder,autocomplete:"off"},domProps:{value:t.inputText},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.sendMessage.apply(null,arguments))},input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.sendMessage}},[t._v(t._s(t.t.send))])])])])]):e("div",{staticClass:"chat-page chat-page--no-init"},[t._m(0),e("p",[e("router-link",{attrs:{to:"/"}},[t._v("← Back to intro")])],1)])},F=[function(){var t=this,e=t._self._c;return e("p",[t._v("Token is required. Add "),e("code",[t._v("?token=<JWT>")]),t._v(" to the URL, or get a token via "),e("code",[t._v("GET /v1/chat-token")]),t._v(".")])}];s(4114),s(8111),s(1701),s(3110),s(4603),s(7566),s(8721);const x=["en","es","ko","zh","ja"],L={en:{placeholder:"Type a message...",send:"Send",sendNew:"New conversation",empty:"Type a message.",emptyFull:"Start a new chat or select one from the list.",me:"Me",bot:"Bot",errorList:"Failed to load conversations.",errorMessages:"Failed to load messages.",errorSend:"Send failed."},es:{placeholder:"Escribe un mensaje...",send:"Enviar",sendNew:"Nueva conversación",empty:"Escribe un mensaje.",emptyFull:"Inicia un chat nuevo o elige uno de la lista.",me:"Yo",bot:"Bot",errorList:"Error al cargar conversaciones.",errorMessages:"Error al cargar mensajes.",errorSend:"Error al enviar."},ko:{placeholder:"메시지를 입력하세요...",send:"전송",sendNew:"새 대화",empty:"메시지를 입력하세요.",emptyFull:"새 대화를 시작하거나 왼쪽에서 대화를 선택하세요.",me:"나",bot:"봇",errorList:"대화 목록 조회 실패.",errorMessages:"메시지 조회 실패.",errorSend:"전송 실패."},zh:{placeholder:"输入消息...",send:"发送",sendNew:"新对话",empty:"输入消息。",emptyFull:"开始新对话或从列表中选择。",me:"我",bot:"助手",errorList:"加载对话列表失败。",errorMessages:"加载消息失败。",errorSend:"发送失败。"},ja:{placeholder:"メッセージを入力...",send:"送信",sendNew:"新しい会話",empty:"メッセージを入力してください。",emptyFull:"新しい会話を始めるか、一覧から選択してください。",me:"自分",bot:"ボット",errorList:"会話一覧の取得に失敗しました。",errorMessages:"メッセージの取得に失敗しました。",errorSend:"送信に失敗しました。"}};function N(t){if(t&&x.includes(t))return t;const e=(navigator.language||navigator.userLanguage||"").toLowerCase();return e.startsWith("ko")?"ko":e.startsWith("ja")?"ja":e.startsWith("zh")?"zh":e.startsWith("es")?"es":"en"}var U={name:"Chat",props:{chatToken:{type:String,default:""},chatSystemId:{type:String,default:""},chatUserId:{type:String,default:""},inModal:{type:Boolean,default:!1}},data(){const t=N(null);return{lang:t,t:L[t]||L.en,conversations:[],currentConversationId:null,messages:[],inputText:"",error:""}},computed:{init(){if(this.chatToken&&this.chatSystemId&&this.chatUserId)return{token:this.chatToken,systemId:this.chatSystemId,userId:this.chatUserId,embed:!1,lang:""};let t="undefined"!==typeof window&&window.__CHAT_INIT__||{};if(!t.token&&"undefined"!==typeof window){const s=new URLSearchParams(window.location.search),a=s.get("token"),i="1"===s.get("embed"),o=s.get("lang")||"";if(a)try{const e=JSON.parse(atob(a.split(".")[1]));t={token:a,systemId:e.system_id||"",userId:e.user_id||"",embed:i,lang:o}}catch(e){t={}}}return t.token&&void 0!==t.systemId&&void 0!==t.userId?t:null},emptyText(){return this.init&&this.init.embed?this.t.empty:this.t.emptyFull}},mounted(){this.init&&!this.init.embed&&this.loadConversations()},updated(){this.$nextTick(()=>{const t=this.$refs.messages;t&&(t.scrollTop=t.scrollHeight)})},methods:{authHeader(){return{Authorization:"Bearer "+this.init.token,"Content-Type":"application/json"}},escapeHtml(t){if(null==t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML},newConversation(){this.currentConversationId=null,this.messages=[],this.error=""},async loadConversations(){if(this.init&&!this.init.embed)try{const t=await fetch((C||"")+"/v1/conversations?system_id="+encodeURIComponent(this.init.systemId)+"&user_id="+encodeURIComponent(this.init.userId),{headers:this.authHeader()});if(!t.ok)throw new Error(this.t.errorList);this.conversations=await t.json()}catch(t){this.error=t.message||this.t.errorList}},async deleteConversation(t){if(this.init&&!this.init.embed)try{const s=await fetch((C||"")+"/v1/conversations/"+encodeURIComponent(t)+"?system_id="+encodeURIComponent(this.init.systemId)+"&user_id="+encodeURIComponent(this.init.userId),{method:"DELETE",headers:this.authHeader()});if(!s.ok){const t=await s.text();let a=t;try{const e=JSON.parse(t);e.detail&&(a="string"===typeof e.detail?e.detail:JSON.stringify(e.detail))}catch(e){}throw new Error(a)}this.currentConversationId===t&&(this.currentConversationId=null,this.messages=[]),await this.loadConversations()}catch(s){this.error=s.message||"삭제 실패"}},async selectConversation(t){if(this.init&&!this.init.embed&&(this.currentConversationId=t,this.messages=[],t))try{const e=await fetch((C||"")+"/v1/conversations/"+encodeURIComponent(t)+"/messages?system_id="+encodeURIComponent(this.init.systemId)+"&user_id="+encodeURIComponent(this.init.userId),{headers:this.authHeader()});if(!e.ok)throw new Error(this.t.errorMessages);const s=await e.json();this.messages=s.map(t=>({role:t.role,content:t.content}))}catch(e){this.error=e.message||this.t.errorMessages}},async sendMessage(){const t=this.inputText.trim();if(t&&this.init){this.error="",this.inputText="",this.messages.push({role:"user",content:t});try{const s={message:t,inputs:{language:this.lang}};this.currentConversationId&&(s.conversation_id=this.currentConversationId);const a=await fetch((C||"")+"/v1/chat",{method:"POST",headers:this.authHeader(),body:JSON.stringify(s)});if(!a.ok){const t=await a.text();let s=t;try{const e=JSON.parse(t);e.detail&&(s="string"===typeof e.detail?e.detail:JSON.stringify(e.detail))}catch(e){}throw new Error(s||this.t.errorSend)}const i=await a.json();i.conversation_id&&(this.currentConversationId=i.conversation_id),this.messages.push({role:"assistant",content:i.answer||""}),this.init.embed||this.loadConversations()}catch(s){this.error=s.message||this.t.errorSend}}}}},H=U,j=(0,c.A)(H,R,F,!1,null,"dbfa4aac",null),z=j.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-page"},[e("div",{staticClass:"login-card"},[e("h1",[t._v(t._s(t.$t("auth.login")))]),e("p",{staticClass:"subtitle"},[t._v(t._s(t.$t("auth.loginSubtitle")))]),e("form",{staticClass:"login-form",on:{submit:function(e){return e.preventDefault(),t.handleLogin.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"username"}},[t._v(t._s(t.$t("common.username")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-input",attrs:{id:"username",type:"text",placeholder:t.$t("auth.usernamePlaceholder"),required:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"password"}},[t._v(t._s(t.$t("common.password")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-input",attrs:{id:"password",type:"password",placeholder:t.$t("common.password"),required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t.error?e("p",{staticClass:"error-msg"},[t._v(t._s(t.error))]):t._e(),e("button",{staticClass:"btn-submit",attrs:{type:"submit",disabled:t.loading}},[t._v(" "+t._s(t.loading?t.$t("auth.loggingIn"):t.$t("auth.loginButton"))+" ")])]),e("p",{staticClass:"footer-note"},[e("router-link",{attrs:{to:"/register"}},[t._v(t._s(t.$t("menu.register")))])],1)])])},M=[];const q="admin_token";var G={name:"Login",data(){return{username:"",password:"",loading:!1,error:""}},methods:{async handleLogin(){this.error="",this.loading=!0;try{const t=await fetch("/v1/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username.trim(),password:this.password})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||this.$t("auth.loginFailed"))}const e=await t.json(),s=e.access_token;if(!s)throw new Error(this.$t("auth.tokenError"));localStorage.setItem(q,s),this.$router.replace("/admin")}catch(t){this.error=t.message||this.$t("auth.loginError")}finally{this.loading=!1}}}},B=G,W=(0,c.A)(B,O,M,!1,null,"6282c9ff",null),K=W.exports,Y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"register-page"},[e("div",{staticClass:"register-card"},[e("h1",[t._v(t._s(t.$t("auth.register")))]),e("p",{staticClass:"subtitle"},[t._v(t._s(t.$t("auth.registerSubtitle")))]),e("form",{staticClass:"register-form",on:{submit:function(e){return e.preventDefault(),t.handleRegister.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"username"}},[t._v(t._s(t.$t("common.username")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-input",attrs:{id:"username",type:"text",placeholder:t.$t("auth.loginIdPlaceholder"),required:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("common.name")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-input",attrs:{id:"name",type:"text",placeholder:t.$t("auth.namePlaceholder"),required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"email"}},[t._v(t._s(t.$t("common.email")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-input",attrs:{id:"email",type:"email",placeholder:t.$t("auth.emailPlaceholder"),required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"password"}},[t._v(t._s(t.$t("common.password")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-input",attrs:{id:"password",type:"password",placeholder:t.$t("auth.passwordPlaceholder"),required:"",minlength:"6"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"passwordConfirm"}},[t._v(t._s(t.$t("common.passwordConfirm")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordConfirm,expression:"passwordConfirm"}],staticClass:"form-input",attrs:{id:"passwordConfirm",type:"password",placeholder:t.$t("auth.passwordConfirmPlaceholder"),required:"",minlength:"6"},domProps:{value:t.passwordConfirm},on:{input:function(e){e.target.composing||(t.passwordConfirm=e.target.value)}}})]),t.error?e("p",{staticClass:"error-msg"},[t._v(t._s(t.error))]):t._e(),e("button",{staticClass:"btn-submit",attrs:{type:"submit",disabled:t.loading}},[t._v(" "+t._s(t.loading?t.$t("auth.registering"):t.$t("auth.registerButton"))+" ")])]),e("p",{staticClass:"footer-note"},[t._v(" "+t._s(t.$t("auth.registerLink"))+" "),e("router-link",{attrs:{to:"/login"}},[t._v(t._s(t.$t("menu.login")))])],1)])])},J=[];const Q="admin_token";var Z={name:"Register",data(){return{username:"",name:"",email:"",password:"",passwordConfirm:"",loading:!1,error:""}},methods:{async handleRegister(){if(this.error="",this.password.length<6)this.error=this.$t("auth.passwordMinLength");else if(this.password===this.passwordConfirm){this.loading=!0;try{const t=await fetch("/v1/admin/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username.trim(),name:this.name.trim(),email:this.email.trim().toLowerCase(),password:this.password,password_confirm:this.passwordConfirm})});if(!t.ok){const e=await t.json().catch(()=>({})),s=Array.isArray(e.detail)&&e.detail[0]?.msg||e.detail;throw new Error("string"===typeof s?s:this.$t("auth.registerFailed"))}const e=await t.json(),s=e.access_token;if(!s)throw new Error(this.$t("auth.tokenError"));localStorage.setItem(Q,s),this.$router.replace("/admin")}catch(t){this.error=t.message||this.$t("auth.registerError")}finally{this.loading=!1}}else this.error=this.$t("auth.passwordMismatch")}}},V=Z,X=(0,c.A)(V,Y,J,!1,null,"3a2e22ac",null),tt=X.exports,et=function(){var t=this,e=t._self._c;return e("div",{staticClass:"admin-page-wrap"},[e("div",{staticClass:"admin-page"},[e("div",{staticClass:"admin-header"},[e("h1",[t._v(t._s(t.$t("admin.chatList")))])]),e("div",{staticClass:"filters-card"},[e("div",{staticClass:"filters"},[e("label",[t._v(t._s(t.$t("admin.system"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.systemId,expression:"filters.systemId"}],attrs:{placeholder:"e.g. cointutor"},domProps:{value:t.filters.systemId},on:{input:function(e){e.target.composing||t.$set(t.filters,"systemId",e.target.value)}}})]),e("label",[t._v(t._s(t.$t("admin.user"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.userId,expression:"filters.userId"}],attrs:{placeholder:"e.g. 12345"},domProps:{value:t.filters.userId},on:{input:function(e){e.target.composing||t.$set(t.filters,"userId",e.target.value)}}})]),e("label",[t._v(t._s(t.$t("admin.from"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.fromDate,expression:"filters.fromDate"}],attrs:{type:"date"},domProps:{value:t.filters.fromDate},on:{input:function(e){e.target.composing||t.$set(t.filters,"fromDate",e.target.value)}}})]),e("label",[t._v(t._s(t.$t("admin.to"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.toDate,expression:"filters.toDate"}],attrs:{type:"date"},domProps:{value:t.filters.toDate},on:{input:function(e){e.target.composing||t.$set(t.filters,"toDate",e.target.value)}}})]),e("button",{staticClass:"btn-search",on:{click:t.doSearch}},[t._v(t._s(t.$t("common.search")))]),t.conversations.length>0?e("button",{staticClass:"btn-select",on:{click:t.toggleSelectAll}},[t._v(t._s(t.allSelected?t.$t("admin.deselectAll"):t.$t("admin.selectAll")))]):t._e(),t.selectedIds.size>0?e("button",{staticClass:"btn-delete",attrs:{disabled:t.deleting},on:{click:t.deleteSelected}},[t._v(t._s(t.deleting?t.$t("common.deleting"):t.$t("admin.deleteSelected")+" ("+t.selectedIds.size+")"))]):t._e()])]),t.error?e("p",{staticClass:"error"},[t._v(t._s(t.error))]):t._e(),e("div",{staticClass:"conv-table-wrap"},[e("table",{staticClass:"conv-table"},[e("thead",[e("tr",[e("th",{staticClass:"col-check"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.allSelected},on:{change:t.toggleSelectAll}})]),e("th",[t._v(t._s(t.$t("admin.system")))]),e("th",[t._v(t._s(t.$t("admin.user")))]),e("th",[t._v(t._s(t.$t("common.name")))]),e("th",[t._v(t._s(t.$t("admin.created")))])])]),e("tbody",t._l(t.conversations,function(s){return e("tr",{key:s.conversation_id,staticClass:"row-click",class:{"row-selected":t.isSelected(s)},on:{click:function(e){return t.loadMessages(s)}}},[e("td",{staticClass:"col-check",on:{click:function(t){t.stopPropagation()}}},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.isSelected(s)},on:{change:function(e){return t.toggleSelect(s)}}})]),e("td",[t._v(t._s(s.system_id))]),e("td",[t._v(t._s(s.user_id))]),e("td",[t._v(t._s(s.name||"-"))]),e("td",[t._v(t._s(t.formatDate(s.created_at)))])])}),0)])]),t.loading||t.hasSearched?t.loading||0!==t.conversations.length?t._e():e("p",{staticClass:"empty"},[t._v(t._s(t.$t("admin.noConversations")))]):e("p",{staticClass:"empty"},[t._v(t._s(t.$t("admin.emptySearchHint")))]),t.selectedConv?e("div",{staticClass:"messages-card"},[e("div",{staticClass:"messages-box"},[e("h3",[t._v(t._s(t.$t("admin.messages"))+": "+t._s(t.selectedConv.name||t.selectedConv.conversation_id))]),t._l(t.messages,function(s){return e("div",{key:s.message_id,class:["message","msg-"+s.role]},[e("strong",[t._v(t._s("user"===s.role?t.$t("admin.msgUser"):t.$t("admin.msgBot")))]),t._v(" "+t._s(t.formatDate(s.created_at))),e("br"),t._v(" "+t._s(s.content)+" ")])})],2)]):t._e()])])},st=[];s(2489),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);const at="admin_token";var it={name:"Admin",data(){return{conversations:[],messages:[],selectedConv:null,selectedIds:new Set,filters:{systemId:"",userId:"",fromDate:"",toDate:""},loading:!1,deleting:!1,error:"",hasSearched:!1}},computed:{allSelected(){return this.conversations.length>0&&this.selectedIds.size===this.conversations.length}},mounted(){const t=localStorage.getItem(at);t||this.$router.replace("/login")},methods:{authHeaders(){const t=localStorage.getItem(at);return t?{Authorization:"Bearer "+t}:{}},async doSearch(){this.error="",this.loading=!0;const t=new URLSearchParams,e=this.filters.systemId.trim(),s=this.filters.userId.trim();e&&t.set("system_id",e),s&&t.set("user_id",s),this.filters.fromDate&&t.set("from_date",this.filters.fromDate),this.filters.toDate&&t.set("to_date",this.filters.toDate);try{const e=await fetch("/v1/admin/conversations?"+t.toString(),{headers:this.authHeaders()});if(401===e.status)return localStorage.removeItem(at),void this.$router.replace("/login");if(!e.ok)throw new Error(await e.text());this.conversations=await e.json(),this.selectedConv=null,this.selectedIds=new Set,this.messages=[],this.hasSearched=!0}catch(a){this.error=a.message}finally{this.loading=!1}},async loadMessages(t){this.error="";try{const e="/v1/admin/conversations/"+encodeURIComponent(t.conversation_id)+"/messages?system_id="+encodeURIComponent(t.system_id)+"&user_id="+encodeURIComponent(t.user_id),s=await fetch(e,{headers:this.authHeaders()});if(401===s.status)return localStorage.removeItem(at),void this.$router.replace("/login");if(!s.ok)throw new Error("Failed to load messages");this.messages=await s.json(),this.selectedConv=t}catch(e){this.error=e.message}},_convKey(t){return t.conversation_id+"|"+t.system_id+"|"+t.user_id},isSelected(t){return this.selectedIds.has(this._convKey(t))},toggleSelect(t){const e=this._convKey(t);this.selectedIds.has(e)?this.selectedIds.delete(e):this.selectedIds.add(e),this.selectedIds=new Set(this.selectedIds)},toggleSelectAll(){this.allSelected?this.selectedIds=new Set:this.selectedIds=new Set(this.conversations.map(t=>this._convKey(t)))},async deleteSelected(){if(0===this.selectedIds.size)return;this.error="",this.deleting=!0;const t=this.conversations.filter(t=>this.selectedIds.has(this._convKey(t)));let e=0;for(const i of t)try{const t=await fetch("/v1/admin/conversations/"+encodeURIComponent(i.conversation_id)+"?system_id="+encodeURIComponent(i.system_id)+"&user_id="+encodeURIComponent(i.user_id),{method:"DELETE",headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(at),void this.$router.replace("/login");if(t.ok)this.selectedIds.delete(this._convKey(i));else{const a=await t.text();try{const t=JSON.parse(a);this.error=(t.detail||a).toString()}catch(s){this.error=a}e++}}catch(a){this.error=a.message,e++}this.selectedIds=new Set(this.selectedIds),this.deleting=!1,0===e&&await this.doSearch()},formatDate(t){if(!t)return"-";try{const e=new Date(t);return isNaN(e.getTime())?t:e.toLocaleString()}catch(e){return t}}}},ot=it,rt=(0,c.A)(ot,et,st,!1,null,"54a32e09",null),nt=rt.exports,lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"admin-systems-page"},[e("div",{staticClass:"admin-page"},[e("div",{staticClass:"admin-header"},[e("h1",[t._v(t._s(t.$t("systems.title")))]),e("div",{staticClass:"header-actions"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/admin"}},[t._v(t._s(t.$t("systems.chatList")))]),e("button",{staticClass:"nav-link btn-sample-download",attrs:{type:"button"},on:{click:t.downloadSampleZip}},[t._v(t._s(t.$t("systems.sampleCode")))]),e("button",{staticClass:"btn-apply-settings-header",attrs:{type:"button",disabled:t.applyingSettings},on:{click:t.applySettings}},[t._v(" "+t._s(t.applyingSettings?t.$t("systems.applyingSettings"):t.$t("systems.applySettings"))+" ")]),e("button",{staticClass:"btn-add",on:{click:function(e){return t.openForm()}}},[t._v(t._s(t.$t("systems.add")))])],1)]),t.showForm?e("div",{staticClass:"form-page"},[e("h2",[t._v(t._s(t.editing?t.$t("systems.editSystem"):t.$t("systems.addSystem")))]),e("div",{staticClass:"form-card"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}}},[e("div",{staticClass:"form-row"},[e("label",[t._v("System ID")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.system_id,expression:"form.system_id"}],attrs:{type:"text",required:"",disabled:t.editing,placeholder:"e.g. drillquiz"},domProps:{value:t.form.system_id},on:{input:function(e){e.target.composing||t.$set(t.form,"system_id",e.target.value)}}})]),e("div",{staticClass:"form-row"},[e("label",[t._v(t._s(t.$t("systems.displayName")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.display_name,expression:"form.display_name"}],attrs:{type:"text",placeholder:"e.g. DrillQuiz"},domProps:{value:t.form.display_name},on:{input:function(e){e.target.composing||t.$set(t.form,"display_name",e.target.value)}}})]),e("div",{staticClass:"form-row"},[e("label",[t._v("Dify Base URL")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.dify_base_url,expression:"form.dify_base_url"}],attrs:{type:"text",required:"",placeholder:"https://dify.drillquiz.com"},domProps:{value:t.form.dify_base_url},on:{input:function(e){e.target.composing||t.$set(t.form,"dify_base_url",e.target.value)}}})]),e("div",{staticClass:"form-row"},[e("label",[t._v(t._s(t.$t("systems.difyApp")))]),e("div",{staticClass:"form-field"},[e("a",{staticClass:"dify-apps-link",attrs:{href:t.difyAppsUrl,target:"_blank",rel:"noopener noreferrer"}},[t._v(" "+t._s(t.editing?t.$t("systems.difyAppsCheck"):t.$t("systems.difyAppsCreate"))+" ")]),e("span",{staticClass:"hint"},[t._v(t._s(t.editing?t.$t("systems.difyHintEdit"):t.$t("systems.difyHintCreate")))]),e("span",{staticClass:"sample-link-wrap"},[e("button",{staticClass:"btn-sample",attrs:{type:"button"},on:{click:t.openSampleModal}},[t._v(t._s(t.$t("systems.dslSample")))])])])]),t.editing?[e("div",{staticClass:"form-row"},[e("label",[t._v("Dify API Key")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.dify_api_key,expression:"form.dify_api_key"}],attrs:{type:"password",required:"",placeholder:"app-xxx"},domProps:{value:t.form.dify_api_key},on:{input:function(e){e.target.composing||t.$set(t.form,"dify_api_key",e.target.value)}}})]),e("div",{staticClass:"form-row"},[e("label",[t._v("Dify Chatbot Token (임베드용)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.dify_chatbot_token,expression:"form.dify_chatbot_token"}],attrs:{type:"password",placeholder:"Dify Publish → 임베드 에서 발급"},domProps:{value:t.form.dify_chatbot_token},on:{input:function(e){e.target.composing||t.$set(t.form,"dify_chatbot_token",e.target.value)}}})])]:t._e(),e("div",{staticClass:"form-row"},[t._m(0),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.allowed_origins,expression:"form.allowed_origins"}],attrs:{placeholder:"https://example.com,https://app.example.com",rows:"3"},domProps:{value:t.form.allowed_origins},on:{input:function(e){e.target.composing||t.$set(t.form,"allowed_origins",e.target.value)}}})]),e("div",{staticClass:"form-row form-row-checkbox"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.enabled,expression:"form.enabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.enabled)?t._i(t.form.enabled,null)>-1:t.form.enabled},on:{change:function(e){var s=t.form.enabled,a=e.target,i=!!a.checked;if(Array.isArray(s)){var o=null,r=t._i(s,o);a.checked?r<0&&t.$set(t.form,"enabled",s.concat([o])):r>-1&&t.$set(t.form,"enabled",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.form,"enabled",i)}}}),t._v(" "+t._s(t.$t("systems.active")))])]),t.editing?e("div",{staticClass:"form-row rag-files-section"},[e("label",[t._v("MinIO RAG 파일 (rag-docs/raw/"+t._s(t.editing.system_id)+"/)")]),e("div",{staticClass:"rag-files-list"},[t.ragFilesLoading?e("div",{staticClass:"rag-loading"},[t._v(t._s(t.$t("systems.loadingFiles")))]):t.ragFiles.length?e("table",{staticClass:"rag-files-table"},[e("thead",[e("tr",[e("th",[t._v(t._s(t.$t("systems.filename")))]),e("th",[t._v(t._s(t.$t("systems.size")))]),e("th",[t._v(t._s(t.$t("systems.modified")))]),e("th")])]),e("tbody",t._l(t.ragFiles,function(s){return e("tr",{key:s.object_name},[e("td",[t._v(t._s(s.filename))]),e("td",[t._v(t._s(t.formatSize(s.size)))]),e("td",[t._v(t._s(t.formatDate(s.last_modified)))]),e("td",[e("button",{staticClass:"btn-del-small",attrs:{type:"button",title:t.$t("common.delete")},on:{click:function(e){return t.confirmDeleteRagFile(s)}}},[t._v(t._s(t.$t("common.delete")))])])])}),0)]):e("p",{staticClass:"rag-empty"},[t._v(t._s(t.$t("systems.noFiles")))])]),e("div",{staticClass:"upload-controls"},[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".pdf,.txt,.md,.zip"},on:{change:t.onFileSelect}}),e("button",{staticClass:"btn-upload",attrs:{type:"button"},on:{click:function(e){t.$refs.fileInput?.click()}}},[t._v(t._s(t.$t("systems.selectFile")))]),t.uploadFile?e("span",{staticClass:"upload-filename"},[t._v(t._s(t.uploadFile.name))]):t._e(),t.uploadFile?e("button",{staticClass:"btn-do-upload",attrs:{type:"button",disabled:t.uploading},on:{click:t.doUpload}},[t._v(" "+t._s(t.uploading?t.$t("systems.uploading"):t.$t("systems.upload"))+" ")]):t._e()]),e("p",{staticClass:"hint"},[t._v(t._s(t.$t("systems.uploadHint")))]),t.uploadResult?e("p",{staticClass:"upload-result"},[t._v(t._s(t.uploadResult))]):t._e(),e("div",{staticClass:"rag-table-actions"},[e("button",{staticClass:"btn-reindex",attrs:{type:"button",disabled:t.reindexing},on:{click:t.triggerReindex}},[t._v(" "+t._s(t.reindexing?t.$t("systems.running"):t.$t("systems.ragRun"))+" ")]),e("button",{staticClass:"btn-apply-settings",attrs:{type:"button",disabled:t.applyingSettings},on:{click:t.applySettings}},[t._v(" "+t._s(t.applyingSettings?t.$t("systems.applyingSettings"):t.$t("systems.applySettings"))+" ")])])]):t._e(),t.formError?e("p",{staticClass:"error"},[t._v(t._s(t.formError))]):t._e(),e("div",{staticClass:"form-actions"},[e("button",{staticClass:"btn-cancel",attrs:{type:"button"},on:{click:t.closeForm}},[t._v(t._s(t.$t("common.cancel")))]),e("button",{staticClass:"btn-save",attrs:{type:"submit",disabled:t.saving}},[t._v(t._s(t.saving?t.$t("common.saving"):t.$t("common.save")))])])],2)])]):[e("div",{staticClass:"systems-table-wrap"},[e("table",{staticClass:"systems-table"},[e("thead",[e("tr",[e("th",[t._v("System ID")]),e("th",[t._v(t._s(t.$t("systems.displayName")))]),e("th",[t._v("Dify URL")]),e("th",[t._v("Chatbot Token")]),e("th",[t._v(t._s(t.$t("systems.active")))]),e("th",[t._v(t._s(t.$t("systems.manage")))])])]),e("tbody",t._l(t.systems,function(s){return e("tr",{key:s.system_id},[e("td",[t._v(t._s(s.system_id))]),e("td",[t._v(t._s(s.display_name||"-"))]),e("td",{staticClass:"url-cell"},[t._v(t._s(s.dify_base_url||"-"))]),e("td",{staticClass:"key-cell"},[t._v(t._s(t.maskKey(s.dify_chatbot_token)))]),e("td",[t._v(t._s(s.enabled?"Y":"N"))]),e("td",[e("button",{staticClass:"btn-test",on:{click:function(e){return t.openTestChat(s)}}},[t._v(t._s(t.$t("common.test")))]),e("button",{staticClass:"btn-edit",on:{click:function(e){return t.openForm(s)}}},[t._v(t._s(t.$t("common.edit")))]),e("button",{staticClass:"btn-del",on:{click:function(e){return t.confirmDelete(s)}}},[t._v(t._s(t.$t("common.delete")))])])])}),0)])]),t.loading||0!==t.systems.length?t._e():e("p",{staticClass:"empty"},[t._v(t._s(t.$t("systems.noSystems")))])],t.deleteTarget?e("div",{staticClass:"modal-overlay",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.deleteTarget=null}}},[e("div",{staticClass:"modal"},[e("h3",[t._v(t._s(t.$t("systems.confirmDelete")))]),e("p",[t._v(t._s(t.deleteTarget.system_id)+t._s(t.$t("systems.deleteSystemConfirm")))]),e("div",{staticClass:"form-actions"},[e("button",{staticClass:"btn-cancel",attrs:{type:"button"},on:{click:function(e){t.deleteTarget=null}}},[t._v(t._s(t.$t("common.cancel")))]),e("button",{staticClass:"btn-del",attrs:{type:"button",disabled:t.deleting},on:{click:t.doDelete}},[t._v(t._s(t.deleting?t.$t("common.deleting"):t.$t("common.delete")))])])])]):t._e(),t.deleteRagTarget?e("div",{staticClass:"modal-overlay",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.deleteRagTarget=null}}},[e("div",{staticClass:"modal"},[e("h3",[t._v(t._s(t.$t("systems.deleteRagFile")))]),e("p",[t._v(t._s(t.deleteRagTarget?.filename)+" "+t._s(t.$t("systems.deleteRagConfirm")))]),e("div",{staticClass:"form-actions"},[e("button",{staticClass:"btn-cancel",attrs:{type:"button"},on:{click:function(e){t.deleteRagTarget=null}}},[t._v(t._s(t.$t("common.cancel")))]),e("button",{staticClass:"btn-del",attrs:{type:"button",disabled:t.deletingRag},on:{click:t.doDeleteRagFile}},[t._v(t._s(t.deletingRag?t.$t("common.deleting"):t.$t("common.delete")))])])])]):t._e(),t.showSampleModal?e("div",{staticClass:"modal-overlay",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showSampleModal=!1}}},[e("div",{staticClass:"modal modal-sample"},[e("h3",[t._v(t._s(t.$t("systems.sampleYamlTitle")))]),e("p",{staticClass:"sample-hint"},[t._v(t._s(t.$t("systems.sampleYamlHint")))]),e("pre",{staticClass:"sample-code"},[t._v(t._s(t.sampleYaml))]),e("div",{staticClass:"form-actions"},[e("button",{staticClass:"btn-cancel",attrs:{type:"button"},on:{click:function(e){t.showSampleModal=!1}}},[t._v(t._s(t.$t("common.close")))])])])]):t._e(),t.applyingSettings?e("div",{staticClass:"modal-overlay applying-overlay"},[e("div",{staticClass:"applying-panel"},[e("div",{staticClass:"spinner"}),e("p",{staticClass:"applying-text"},[t._v(t._s(t.$t("systems.restarting")))]),e("p",{staticClass:"applying-hint"},[t._v(t._s(t.$t("systems.restartHint")))])])]):t._e(),t.showTestChat?e("div",{staticClass:"modal-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTestChat.apply(null,arguments)}}},[e("div",{staticClass:"modal modal-chat"},[e("div",{staticClass:"modal-chat-header"},[e("h3",[t._v(t._s(t.$t("systems.chatTest"))+" — "+t._s(t.testChatSystemId))]),e("button",{staticClass:"btn-close",attrs:{type:"button"},on:{click:t.closeTestChat}},[t._v(t._s(t.$t("common.close")))])]),t.testChatToken?e("div",{staticClass:"modal-chat-body"},[e("Chat",{attrs:{"chat-token":t.testChatToken,"chat-system-id":t.testChatSystemId,"chat-user-id":t.testChatUserId,"in-modal":""}})],1):t._e()])]):t._e()],2)])},dt=[function(){var t=this,e=t._self._c;return e("label",[t._v("Allowed Origins"),e("br"),t._v("(쉼표 구분)")])}];const ct="admin_token",mt="/v1/admin/systems";var pt={name:"AdminSystems",components:{Chat:z},data(){return{systems:[],loading:!1,showForm:!1,editing:null,form:{system_id:"",display_name:"",dify_base_url:"",dify_api_key:"",dify_chatbot_token:"",allowed_origins:"",enabled:!0},formError:"",saving:!1,deleteTarget:null,deleting:!1,showTestChat:!1,testChatToken:"",testChatSystemId:"",testChatUserId:"",uploadFile:null,uploading:!1,uploadResult:"",ragFiles:[],ragFilesLoading:!1,deleteRagTarget:null,deletingRag:!1,reindexing:!1,applyingSettings:!1,showSampleModal:!1,sampleYaml:""}},computed:{difyAppsUrl(){const t=(this.form.dify_base_url||"https://dify.drillquiz.com").trim().replace(/\/$/,"");return t+"/apps"}},mounted(){const t=localStorage.getItem(ct);t?this.load():this.$router.replace("/login")},methods:{authHeaders(){const t=localStorage.getItem(ct);return t?{Authorization:"Bearer "+t}:{}},async load(){this.loading=!0;try{const t=await fetch(mt,{headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok)throw new Error(await t.text());this.systems=await t.json()}catch(t){this.formError=t.message}finally{this.loading=!1}},maskKey(t){return t?t.length<=8?"***":t.slice(0,4)+"..."+t.slice(-4):"-"},async openTestChat(t){this.formError="";try{const e=await fetch(mt+"/"+encodeURIComponent(t.system_id)+"/test-token",{headers:this.authHeaders()});if(401===e.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.detail||"토큰 발급 실패")}const{token:s}=await e.json();this.testChatToken=s,this.testChatSystemId=t.system_id,this.testChatUserId="admin_test",this.showTestChat=!0}catch(e){this.formError=e.message}},async downloadSampleZip(){this.formError="";try{const t=await fetch("/v1/admin/sample/download",{headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok)throw new Error("다운로드 실패");const e=await t.blob(),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="chat-admin-sample.zip",a.click(),URL.revokeObjectURL(s)}catch(t){this.formError=t.message}},async openSampleModal(){if(this.showSampleModal=!0,!this.sampleYaml)try{const t=await fetch("/drillquiz-rag-openapi.yaml");t.ok?this.sampleYaml=await t.text():this.sampleYaml="# 로드 실패"}catch{this.sampleYaml="# 로드 실패"}},closeTestChat(){this.showTestChat=!1,this.testChatToken="",this.testChatSystemId="",this.testChatUserId=""},async openForm(t){this.editing=t||null,this.formError="",t?(this.form={system_id:t.system_id,display_name:t.display_name||"",dify_base_url:t.dify_base_url||"",dify_api_key:t.dify_api_key||"",dify_chatbot_token:t.dify_chatbot_token||"",allowed_origins:t.allowed_origins||"",enabled:t.enabled},this.showForm=!0,await this.loadRagFiles()):(this.form={system_id:"",display_name:"",dify_base_url:"https://dify.drillquiz.com",dify_api_key:"",dify_chatbot_token:"",allowed_origins:"",enabled:!0},this.showForm=!0)},closeForm(){this.showForm=!1,this.editing=null,this.uploadFile=null,this.uploadResult="",this.ragFiles=[],this.deleteRagTarget=null},formatSize(t){return!t||t<1024?(t||0)+" B":t<1048576?(t/1024).toFixed(1)+" KB":(t/1048576).toFixed(1)+" MB"},formatDate(t){if(!t)return"-";try{const e=new Date(t);return isNaN(e.getTime())?t:e.toLocaleString()}catch{return t}},async loadRagFiles(){if(this.editing){this.ragFilesLoading=!0;try{const t=await fetch(mt+"/"+encodeURIComponent(this.editing.system_id)+"/files",{headers:this.authHeaders()});t.ok?this.ragFiles=await t.json():this.ragFiles=[]}catch{this.ragFiles=[]}finally{this.ragFilesLoading=!1}}},confirmDeleteRagFile(t){this.deleteRagTarget=t,this.deletingRag=!1},async triggerReindex(){if(this.editing){this.reindexing=!0,this.formError="";try{const t=await fetch(mt+"/"+encodeURIComponent(this.editing.system_id)+"/trigger-reindex",{method:"POST",headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"인덱싱 실행 실패")}const e=await t.json();this.formError="",this.uploadResult=`Job 실행됨: ${e.job_name||""}`}catch(t){this.formError=t.message}finally{this.reindexing=!1}}},async applySettings(){this.applyingSettings=!0,this.formError="";try{const t=await fetch(mt+"/apply-settings",{method:"POST",headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"설정 반영 실패")}window.location.reload()}catch(t){this.formError=t.message}finally{this.applyingSettings=!1}},async doDeleteRagFile(){if(this.deleteRagTarget&&this.editing){this.deletingRag=!0;try{const t=await fetch(mt+"/"+encodeURIComponent(this.editing.system_id)+"/files?key="+encodeURIComponent(this.deleteRagTarget.object_name),{method:"DELETE",headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok)throw new Error(await t.text());this.deleteRagTarget=null,await this.loadRagFiles()}catch(t){this.formError=t.message}finally{this.deletingRag=!1}}},onFileSelect(t){const e=t.target?.files?.[0];this.uploadFile=e||null,this.uploadResult=""},async doUpload(){if(this.editing&&this.uploadFile){this.uploading=!0,this.formError="",this.uploadResult="";try{const t=new FormData;t.append("file",this.uploadFile);const e=await fetch(mt+"/"+encodeURIComponent(this.editing.system_id)+"/upload",{method:"POST",headers:this.authHeaders(),body:t});if(401===e.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.detail||"업로드 실패")}const s=await e.json();this.uploadResult=`${s.count}개 파일 업로드됨: ${s.uploaded?.join(", ")||""}`,this.uploadFile=null,this.$refs.fileInput&&(this.$refs.fileInput.value=""),await this.loadRagFiles()}catch(t){this.formError=t.message}finally{this.uploading=!1}}},async save(){this.formError="",this.saving=!0;try{if(this.editing){const t=await fetch(mt+"/"+encodeURIComponent(this.editing.system_id),{method:"PATCH",headers:{...this.authHeaders(),"Content-Type":"application/json"},body:JSON.stringify({display_name:this.form.display_name,dify_base_url:this.form.dify_base_url,dify_api_key:this.form.dify_api_key,dify_chatbot_token:this.form.dify_chatbot_token,allowed_origins:this.form.allowed_origins,enabled:this.form.enabled})});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"수정 실패")}}else{const t=await fetch(mt,{method:"POST",headers:{...this.authHeaders(),"Content-Type":"application/json"},body:JSON.stringify(this.form)});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"추가 실패")}}this.closeForm(),await this.load()}catch(t){this.formError=t.message}finally{this.saving=!1}},confirmDelete(t){this.deleteTarget=t,this.deleting=!1},async doDelete(){if(this.deleteTarget){this.deleting=!0;try{const t=await fetch(mt+"/"+encodeURIComponent(this.deleteTarget.system_id),{method:"DELETE",headers:this.authHeaders()});if(401===t.status)return localStorage.removeItem(ct),void this.$router.replace("/login");if(!t.ok)throw new Error(await t.text());this.deleteTarget=null,await this.load()}catch(t){this.formError=t.message}finally{this.deleting=!1}}}}},ht=pt,ut=(0,c.A)(ht,lt,dt,!1,null,"3b192bfb",null),gt=ut.exports,ft=function(){var t=this,e=t._self._c;return e("div",{staticClass:"profile-page"},[e("div",{staticClass:"profile-card"},[e("h1",[t._v(t._s(t.$t("profile.title")))]),e("p",{staticClass:"subtitle"},[t._v(t._s(t.$t("profile.subtitle")))]),t.profile?e("section",{staticClass:"profile-section"},[e("h2",[t._v(t._s(t.$t("profile.basicInfo")))]),e("form",{staticClass:"profile-form",on:{submit:function(e){return e.preventDefault(),t.handleUpdateProfile.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"username"}},[t._v(t._s(t.$t("common.username")))]),e("input",{staticClass:"form-input form-input-readonly",attrs:{id:"username",type:"text",disabled:""},domProps:{value:t.profile.username}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("common.name")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.profileForm.name,expression:"profileForm.name"}],staticClass:"form-input",attrs:{id:"name",type:"text",placeholder:t.$t("common.name"),maxlength:"128"},domProps:{value:t.profileForm.name},on:{input:function(e){e.target.composing||t.$set(t.profileForm,"name",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"email"}},[t._v(t._s(t.$t("common.email")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.profileForm.email,expression:"profileForm.email"}],staticClass:"form-input",attrs:{id:"email",type:"email",placeholder:t.$t("common.email")},domProps:{value:t.profileForm.email},on:{input:function(e){e.target.composing||t.$set(t.profileForm,"email",e.target.value)}}})]),t.profileError?e("p",{staticClass:"error-msg"},[t._v(t._s(t.profileError))]):t._e(),t.profileSuccess?e("p",{staticClass:"success-msg"},[t._v(t._s(t.profileSuccess))]):t._e(),e("button",{staticClass:"btn-submit",attrs:{type:"submit",disabled:t.profileLoading}},[t._v(" "+t._s(t.profileLoading?t.$t("common.saving"):t.$t("common.save"))+" ")])])]):t._e(),e("section",{staticClass:"password-section"},[e("h2",[t._v(t._s(t.$t("profile.changePassword")))]),e("form",{staticClass:"profile-form",on:{submit:function(e){return e.preventDefault(),t.handleChangePassword.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"current"}},[t._v(t._s(t.$t("profile.currentPassword")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordForm.current_password,expression:"passwordForm.current_password"}],staticClass:"form-input",attrs:{id:"current",type:"password",placeholder:t.$t("profile.currentPassword"),required:""},domProps:{value:t.passwordForm.current_password},on:{input:function(e){e.target.composing||t.$set(t.passwordForm,"current_password",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"new"}},[t._v(t._s(t.$t("profile.newPassword")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordForm.new_password,expression:"passwordForm.new_password"}],staticClass:"form-input",attrs:{id:"new",type:"password",placeholder:t.$t("profile.newPasswordPlaceholder"),required:"",minlength:"6"},domProps:{value:t.passwordForm.new_password},on:{input:function(e){e.target.composing||t.$set(t.passwordForm,"new_password",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"confirm"}},[t._v(t._s(t.$t("profile.newPasswordConfirm")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordForm.new_password_confirm,expression:"passwordForm.new_password_confirm"}],staticClass:"form-input",attrs:{id:"confirm",type:"password",placeholder:t.$t("profile.newPasswordConfirmPlaceholder"),required:"",minlength:"6"},domProps:{value:t.passwordForm.new_password_confirm},on:{input:function(e){e.target.composing||t.$set(t.passwordForm,"new_password_confirm",e.target.value)}}})]),t.error?e("p",{staticClass:"error-msg"},[t._v(t._s(t.error))]):t._e(),t.success?e("p",{staticClass:"success-msg"},[t._v(t._s(t.success))]):t._e(),e("button",{staticClass:"btn-submit",attrs:{type:"submit",disabled:t.loading}},[t._v(" "+t._s(t.loading?t.$t("common.saving"):t.$t("profile.changePassword"))+" ")])])])])])},vt=[];const _t="admin_token";var yt={name:"Profile",data(){return{profile:null,profileForm:{name:"",email:""},profileLoading:!1,profileError:"",profileSuccess:"",passwordForm:{current_password:"",new_password:"",new_password_confirm:""},loading:!1,error:"",success:""}},mounted(){const t=localStorage.getItem(_t);t?this.loadProfile():this.$router.replace("/login")},methods:{authHeaders(){const t=localStorage.getItem(_t);return t?{Authorization:"Bearer "+t}:{}},async loadProfile(){try{const t=await fetch("/v1/admin/profile",{headers:this.authHeaders()});if(!t.ok)return void(401===t.status&&this.$router.replace("/login"));const e=await t.json();this.profile=e,this.profileForm={name:e.name||"",email:e.email||""}}catch{this.profile=null}},async handleUpdateProfile(){this.profileError="",this.profileSuccess="",this.profileLoading=!0;try{const t=await fetch("/v1/admin/profile",{method:"PATCH",headers:{"Content-Type":"application/json",...this.authHeaders()},body:JSON.stringify({name:this.profileForm.name.trim(),email:this.profileForm.email.trim()||null})}),e=await t.json().catch(()=>({}));if(!t.ok){const t=Array.isArray(e.detail)?e.detail.map(t=>t.msg).join(", "):e.detail||this.$t("profile.saveError");throw new Error(t)}this.profile=e,this.profileForm={name:e.name||"",email:e.email||""},this.profileSuccess=this.$t("profile.saveSuccess")}catch(t){this.profileError=t.message||this.$t("profile.saveError")}finally{this.profileLoading=!1}},async handleChangePassword(){if(this.error="",this.success="",this.passwordForm.new_password===this.passwordForm.new_password_confirm)if(this.passwordForm.new_password.length<6)this.error=this.$t("profile.newPasswordMinLength");else{this.loading=!0;try{const t=await fetch("/v1/admin/profile/password",{method:"PATCH",headers:{"Content-Type":"application/json",...this.authHeaders()},body:JSON.stringify({current_password:this.passwordForm.current_password,new_password:this.passwordForm.new_password,new_password_confirm:this.passwordForm.new_password_confirm})}),e=await t.json().catch(()=>({}));if(!t.ok){const t=Array.isArray(e.detail)?e.detail.map(t=>t.msg).join(", "):e.detail||this.$t("profile.passwordChangeError");throw new Error(t)}this.success=this.$t("profile.passwordChanged"),this.passwordForm={current_password:"",new_password:"",new_password_confirm:""}}catch(t){this.error=t.message||this.$t("profile.passwordChangeError")}finally{this.loading=!1}}else this.error=this.$t("profile.newPasswordMismatch")}}},wt=yt,Ct=(0,c.A)(wt,ft,vt,!1,null,"78b9d1de",null),bt=Ct.exports;a.Ay.use(h.Ay);const kt=[{path:"/",redirect:"/admin/systems"},{path:"/intro",name:"Intro",component:I},{path:"/about",name:"About",component:E},{path:"/login",name:"Login",component:K},{path:"/register",name:"Register",component:tt},{path:"/admin",name:"Admin",component:nt},{path:"/admin/systems",name:"AdminSystems",component:gt},{path:"/admin/profile",name:"Profile",component:bt},{path:"/chat",name:"Chat",component:z}],St=new h.Ay({mode:"history",base:"/",routes:kt});var It=St,$t=s(6586),At={common:{save:"저장",saving:"저장 중...",cancel:"취소",close:"닫기",delete:"삭제",deleting:"삭제 중...",add:"추가",edit:"수정",search:"검색",test:"테스트",enabled:"활성",name:"이름",email:"이메일",username:"사용자명",password:"비밀번호",passwordConfirm:"비밀번호 확인"},menu:{appName:"TZ-Chat Gateway",chatManage:"채팅관리",chatList:"채팅조회",logout:"로그아웃",about:"About",register:"회원가입",login:"로그인"},auth:{login:"로그인",loginSubtitle:"채팅 관리 페이지에 로그인합니다.",loginButton:"로그인",loggingIn:"로그인 중...",loginFailed:"로그인 실패",loginError:"로그인에 실패했습니다.",tokenError:"토큰을 받지 못했습니다.",register:"관리자 회원가입",registerSubtitle:"채팅 관리용 계정을 생성합니다.",registerButton:"가입",registering:"가입 중...",registerLink:"이미 계정이 있으신가요?",registerFailed:"가입 실패",registerError:"가입에 실패했습니다.",usernamePlaceholder:"사용자명",loginIdPlaceholder:"로그인에 사용할 아이디",namePlaceholder:"이름",emailPlaceholder:"your@email.com",passwordPlaceholder:"비밀번호 (6자 이상)",passwordConfirmPlaceholder:"비밀번호 재입력",passwordMinLength:"비밀번호는 6자 이상이어야 합니다.",passwordMismatch:"비밀번호가 일치하지 않습니다."},profile:{title:"프로필",subtitle:"프로필 정보와 비밀번호를 수정할 수 있습니다.",basicInfo:"기본 정보",changePassword:"비밀번호 변경",currentPassword:"현재 비밀번호",newPassword:"새 비밀번호",newPasswordPlaceholder:"새 비밀번호 (6자 이상)",newPasswordConfirm:"새 비밀번호 확인",newPasswordConfirmPlaceholder:"새 비밀번호 다시 입력",saveSuccess:"저장되었습니다.",saveError:"저장에 실패했습니다.",passwordChanged:"비밀번호가 변경되었습니다.",passwordChangeError:"비밀번호 변경에 실패했습니다.",newPasswordMismatch:"새 비밀번호가 일치하지 않습니다.",newPasswordMinLength:"새 비밀번호는 6자 이상이어야 합니다."},admin:{chatList:"채팅 조회",system:"System",user:"User",from:"From",to:"To",selectAll:"전체 선택",deselectAll:"선택 해제",deleteSelected:"선택 삭제",messages:"Messages",msgUser:"User",msgBot:"Bot",emptySearchHint:"검색 조건을 입력한 후 검색하세요.",noConversations:"조건에 맞는 대화가 없습니다.",created:"Created"},systems:{title:"채팅 관리",chatList:"채팅 조회",sampleCode:"샘플코드",applySettings:"설정 반영",applyingSettings:"적용 중...",add:"추가",addSystem:"시스템 추가",editSystem:"시스템 수정",displayName:"표시명",difyBaseUrl:"Dify Base URL",difyApp:"Dify 앱",difyAppsCheck:"Dify에서 앱 확인 →",difyAppsCreate:"Dify에서 앱 만들기 →",difyHintEdit:"API Key와 Chatbot Token을 입력하세요.",difyHintCreate:"앱 생성 후 '수정'에서 API Key와 Chatbot Token을 입력하세요.",dslSample:"DSL 샘플",difyApiKey:"Dify API Key",difyChatbotToken:"Dify Chatbot Token (임베드용)",difyChatbotTokenPlaceholder:"Dify Publish → 임베드 에서 발급",allowedOrigins:"Allowed Origins (쉼표 구분)",active:"활성",ragFiles:"MinIO RAG 파일",filename:"파일명",size:"크기",modified:"수정일",loadingFiles:"목록 로딩 중...",noFiles:"등록된 파일 없음",selectFile:"파일 선택",uploading:"업로드 중...",upload:"업로드",uploadHint:"PDF, TXT, MD 또는 ZIP (압축 해제 후 업로드)",ragRun:"RAG 실행",running:"실행 중...",manage:"관리",noSystems:"등록된 시스템이 없습니다. '추가' 버튼으로 등록하세요.",confirmDelete:"삭제 확인",deleteSystemConfirm:"를 삭제하시겠습니까?",deleteRagFile:"RAG 파일 삭제",deleteRagConfirm:"삭제할까요?",sampleYamlTitle:"drillquiz-rag-openapi.yaml 샘플",sampleYamlHint:'Dify "Create custom tool" → schema 필드에 붙여넣기',chatTest:"채팅 테스트",restarting:"chat-gateway 재시작 중...",restartHint:"잠시만 기다려 주세요 (최대 2분)"},about:{title:"TZ-Chat Gateway",tagline:"Unified chat API in front of Dify. Part of the tz-chatbot stack.",whatIs:"What this is",project:"Project: tz-chatbot",workflow:"1. Workflow",howItWorks:"2. How the app operates",aboutDetail:"About (상세)"},intro:{tagline:"Unified chat API in front of Dify. Part of the tz-chatbot stack.",whatIs:"What this is",project:"Project: tz-chatbot",workflow:"1. Workflow",aboutDetail:"About (상세)",chatPage:"Chat page",apiDocs:"API docs (OpenAPI)",githubSource:"GitHub source"}},Pt={common:{save:"Save",saving:"Saving...",cancel:"Cancel",close:"Close",delete:"Delete",deleting:"Deleting...",add:"Add",edit:"Edit",search:"Search",test:"Test",enabled:"Enabled",name:"Name",email:"Email",username:"Username",password:"Password",passwordConfirm:"Confirm password"},menu:{appName:"TZ-Chat Gateway",chatManage:"Chat Manage",chatList:"Chat List",logout:"Logout",about:"About",register:"Register",login:"Login"},auth:{login:"Login",loginSubtitle:"Log in to the chat management page.",loginButton:"Login",loggingIn:"Logging in...",loginFailed:"Login failed",loginError:"Login failed.",tokenError:"Failed to receive token.",register:"Admin Registration",registerSubtitle:"Create an account for chat management.",registerButton:"Register",registering:"Registering...",registerLink:"Already have an account?",registerFailed:"Registration failed",registerError:"Registration failed.",usernamePlaceholder:"Username",loginIdPlaceholder:"Login ID",namePlaceholder:"Name",emailPlaceholder:"your@email.com",passwordPlaceholder:"Password (min 6 chars)",passwordConfirmPlaceholder:"Confirm password",passwordMinLength:"Password must be at least 6 characters.",passwordMismatch:"Passwords do not match."},profile:{title:"Profile",subtitle:"Edit your profile information and password.",basicInfo:"Basic Info",changePassword:"Change Password",currentPassword:"Current password",newPassword:"New password",newPasswordPlaceholder:"New password (min 6 chars)",newPasswordConfirm:"Confirm new password",newPasswordConfirmPlaceholder:"Re-enter new password",saveSuccess:"Saved.",saveError:"Save failed.",passwordChanged:"Password changed.",passwordChangeError:"Failed to change password.",newPasswordMismatch:"New passwords do not match.",newPasswordMinLength:"New password must be at least 6 characters."},admin:{chatList:"Chat List",system:"System",user:"User",from:"From",to:"To",selectAll:"Select All",deselectAll:"Deselect",deleteSelected:"Delete Selected",messages:"Messages",msgUser:"User",msgBot:"Bot",emptySearchHint:"Enter search criteria and click Search.",noConversations:"No conversations match.",created:"Created"},systems:{title:"Chat Manage",chatList:"Chat List",sampleCode:"Sample Code",applySettings:"Apply Settings",applyingSettings:"Applying...",add:"Add",addSystem:"Add System",editSystem:"Edit System",displayName:"Display Name",difyBaseUrl:"Dify Base URL",difyApp:"Dify App",difyAppsCheck:"Check app in Dify →",difyAppsCreate:"Create app in Dify →",difyHintEdit:"Enter API Key and Chatbot Token.",difyHintCreate:"After creating the app, enter API Key and Chatbot Token in 'Edit'.",dslSample:"DSL Sample",difyApiKey:"Dify API Key",difyChatbotToken:"Dify Chatbot Token (embed)",difyChatbotTokenPlaceholder:"Dify Publish → Embed",allowedOrigins:"Allowed Origins (comma-separated)",active:"Active",ragFiles:"MinIO RAG files",filename:"Filename",size:"Size",modified:"Modified",loadingFiles:"Loading...",noFiles:"No files",selectFile:"Select file",uploading:"Uploading...",upload:"Upload",uploadHint:"PDF, TXT, MD or ZIP",ragRun:"RAG Run",running:"Running...",manage:"Manage",noSystems:"No systems. Click Add to register.",confirmDelete:"Confirm Delete",deleteSystemConfirm:"Delete this?",deleteRagFile:"Delete RAG File",deleteRagConfirm:"Delete this file?",sampleYamlTitle:"drillquiz-rag-openapi.yaml Sample",sampleYamlHint:'Dify "Create custom tool" → paste in schema field',chatTest:"Chat Test",restarting:"Restarting chat-gateway...",restartHint:"Please wait (up to 2 min)"},about:{title:"TZ-Chat Gateway",tagline:"Unified chat API in front of Dify. Part of the tz-chatbot stack.",whatIs:"What this is",project:"Project: tz-chatbot",workflow:"1. Workflow",howItWorks:"2. How the app operates",aboutDetail:"About (detail)"},intro:{tagline:"Unified chat API in front of Dify. Part of the tz-chatbot stack.",whatIs:"What this is",project:"Project: tz-chatbot",workflow:"1. Workflow",aboutDetail:"About (detail)",chatPage:"Chat page",apiDocs:"API docs (OpenAPI)",githubSource:"GitHub source"}};a.Ay.use($t.A);const Tt="ko",Dt=new $t.A({locale:Tt,fallbackLocale:"en",messages:{ko:At,en:Pt},silentTranslationWarn:!0,missing:(t,e)=>e});function Et(t){return!!["ko","en"].includes(t)&&(Dt.locale=t,localStorage.setItem("language",t),!0)}function Rt(){const t=localStorage.getItem("language"),e=(navigator.language||navigator.userLanguage||"en").toLowerCase(),s=e.startsWith("ko")?"ko":"en",a=t||s;Et(a)}Rt(),a.Ay.prototype.$changeLanguage=Et;var Ft=Dt;a.Ay.config.productionTip=!1,new a.Ay({router:It,i18n:Ft,render:t=>t(p)}).$mount("#app")}},e={};function s(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,a,i,o){if(!a){var r=1/0;for(c=0;c<t.length;c++){a=t[c][0],i=t[c][1],o=t[c][2];for(var n=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(s.O).every(function(t){return s.O[t](a[l])})?a.splice(l--,1):(n=!1,o<r&&(r=o));if(n){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[a,i,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,o,r=a[0],n=a[1],l=a[2],d=0;if(r.some(function(e){return 0!==t[e]})){for(i in n)s.o(n,i)&&(s.m[i]=n[i]);if(l)var c=l(s)}for(e&&e(a);d<r.length;d++)o=r[d],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(c)},a=self["webpackChunkchat_gateway_frontend"]=self["webpackChunkchat_gateway_frontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],function(){return s(6948)});a=s.O(a)})();
//# sourceMappingURL=app.d1217b91.js.map