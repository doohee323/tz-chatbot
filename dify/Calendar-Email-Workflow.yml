# Dify Workflow: Google Calendar ì¼ì • ë°œìƒ ì‹œ ì´ë©”ì¼ ë°œì†¡
# - íŠ¸ë¦¬ê±°: Google Calendar (í”ŒëŸ¬ê·¸ì¸)
# - ì¼ì • ì´ë²¤íŠ¸ ìˆ˜ì‹  â†’ ì´ë©”ì¼ ë°œì†¡
# ì‚¬ìš© ì „: Difyì—ì„œ Google Calendar Trigger, Email í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ ë° OAuth/ì„¤ì • ì™„ë£Œ í›„
# Studio > Workflow ì•± ìƒì„± > Import from YAML ë¡œ ì„í¬íŠ¸

app:
  description: Google Calendar ì¼ì • ë°œìƒ ì‹œ ì§€ì • ìˆ˜ì‹ ìì—ê²Œ ì´ë©”ì¼ ë°œì†¡
  icon: ğŸ“…
  icon_background: '#E8F5E9'
  mode: workflow
  name: Calendar-Email-Workflow
  use_icon_as_answer_icon: false

dependencies:
  - type: marketplace
    value:
      marketplace_plugin_unique_identifier: langgenius/google_calendar_trigger:0.0.1@6afd18607b0cf299a253f314b88f5a89fbbdf6d1d529ebebe3dfc1998952779a
    current_identifier: null
  - type: marketplace
    value:
      marketplace_plugin_unique_identifier: langgenius/email:0.0.5@b0bf4aa3062c9b41ce3eaac8e4ea1987f7daef614702b4f3a11755629b35bb28
    current_identifier: null

kind: app
version: 0.5.0

workflow:
  conversation_variables: []
  environment_variables: []
  features: {}
  graph:
    edges:
      # Google Calendar Trigger â†’ Code (ì´ë²¤íŠ¸ í¬ë§·)
      - id: n1001-source-n1002-target
        source: '1001'
        sourceHandle: source
        target: '1002'
        targetHandle: target
        type: custom
        data:
          sourceType: plugin_trigger
          targetType: code
          isInLoop: false
      # Code â†’ Email
      - id: n1002-source-n1003-target
        source: '1002'
        sourceHandle: source
        target: '1003'
        targetHandle: target
        type: custom
        data:
          sourceType: code
          targetType: tool
          isInLoop: false

    nodes:
      # 1) Google Calendar Trigger
      - id: '1001'
        type: custom
        position: { x: 80, y: 200 }
        data:
          title: Google Calendar Trigger
          type: plugin_trigger
          selected: false
          plugin_id: langgenius/google_calendar_trigger
          plugin_unique_identifier: langgenius/google_calendar_trigger:0.0.1@6afd18607b0cf299a253f314b88f5a89fbbdf6d1d529ebebe3dfc1998952779a
          trigger_config: {}
        width: 242
        height: 54

      # 2) Code: ìº˜ë¦°ë” ì´ë²¤íŠ¸ â†’ ì´ë©”ì¼ ì œëª©/ë³¸ë¬¸ ìƒì„±
      - id: '1002'
        type: custom
        position: { x: 380, y: 200 }
        data:
          title: ì´ë²¤íŠ¸ â†’ ì´ë©”ì¼ ë‚´ìš©
          type: code
          selected: false
          variables: []
          code: |
            def main(trigger_event: dict) -> dict:
                # Google Calendar ì´ë²¤íŠ¸ì—ì„œ ì œëª©/ì‹œê°„/ì„¤ëª… ì¶”ì¶œ (ì‹¤ì œ í˜ì´ë¡œë“œëŠ” í”ŒëŸ¬ê·¸ì¸ ë¬¸ì„œ ì°¸ê³ )
                event = trigger_event.get("event", trigger_event)
                summary = event.get("summary", "ì¼ì • ì•Œë¦¼")
                start = event.get("start", {}).get("dateTime") or event.get("start", {}).get("date", "")
                description = event.get("description", "")
                return {
                    "subject": f"[ìº˜ë¦°ë”] {summary}",
                    "body": f"ì¼ì •: {summary}\nì‹œì‘: {start}\n\n{description}"
                }
          code_language: python3
          output_schema:
            type: object
            properties:
              subject: { type: string, description: "email subject" }
              body: { type: string, description: "email body" }
        width: 242
        height: 54

      # 3) Email ë„êµ¬
      - id: '1003'
        type: custom
        position: { x: 680, y: 200 }
        data:
          title: ì´ë©”ì¼ ë°œì†¡
          type: tool
          selected: false
          is_team_authorization: true
          provider_type: builtin
          provider_id: langgenius/email/email
          provider_name: langgenius/email/email
          plugin_id: langgenius/email
          plugin_unique_identifier: langgenius/email:0.0.5@b0bf4aa3062c9b41ce3eaac8e4ea1987f7daef614702b4f3a11755629b35bb28
          tool_name: send_email
          tool_label: Send Email
          tool_description: Send an email
          tool_parameters:
            to: { type: variable, value: [] }
            subject: { type: variable, value: ['1002', 'subject'] }
            body: { type: variable, value: ['1002', 'body'] }
          paramSchemas: []
          params: {}
        width: 242
        height: 52

    viewport:
      x: 0
      y: 0
      zoom: 1

  workflow_variables: []
