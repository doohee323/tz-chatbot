# 05-3. 실습: 로컬에서 테스트

## 목표

- **chat-gateway**와 **chat-admin**을 로컬에서 실행하고, JWT 발급·채팅 페이지가 동작하는지 확인합니다.  
  (K8s 배포 없이 동작 확인용입니다.)

## 전제

- Python 3.11+ 설치
- Dify가 이미 떠 있다면 `DIFY_BASE_URL`, `DIFY_API_KEY` 설정. 없으면 mock/테스트 모드로 UI만 확인 가능할 수 있음
- `CHAT_GATEWAY_JWT_SECRET` 설정 (JWT 서명용)

## chat-gateway 로컬 실행

```bash
cd chat-gateway
# 가상환경 사용 시
python -m venv .venv
source .venv/bin/activate   # Windows: .venv\Scripts\activate
pip install -r requirements.txt
./gateway.sh
```

- 기본 포트(예: 8088)로 서버 기동 후, 브라우저에서 `http://localhost:8088/` 로 소개 페이지 확인

## JWT 발급 (테스트용)

```bash
cd chat-gateway
./scripts/gen-jwt.sh
# 또는
./scripts/gen-jwt.sh cointutor 999
```

- 출력된 URL(`http://localhost:8088/chat?token=...`)을 브라우저에서 열어 채팅 페이지 접근 가능 여부 확인

## chat-admin 로컬 실행

```bash
cd chat-admin
# 가상환경 사용 시
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
./admin.sh
```

- 기본 포트(예: 8000)로 기동 후, 브라우저에서 `http://localhost:8000/` 접속
- 관리자: 회원가입/로그인 후 시스템(앱) 목록·채팅 조회 등 확인
- 채팅 페이지: JWT가 필요하므로 `gen-jwt.sh`로 발급한 URL 사용 또는 앱에서 발급한 토큰으로 `/chat?token=...` 접속

## 확인 사항

- [ ] gateway 루트(/) 소개 페이지가 보인다
- [ ] JWT URL로 `/chat` 페이지가 열린다
- [ ] admin 루트(/) 접속 후 로그인·시스템 목록(또는 빈 목록)이 보인다

이렇게 로컬에서 동작을 확인한 뒤, 실제 서비스는 K8s에 배포하는 흐름을 섹션 10에서 다룹니다.
