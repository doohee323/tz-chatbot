# 슬라이드 03: 개발/운영 환경 가이드

## 슬라이드 내용 (한 장)

**브랜치와 네임스페이스 매핑**

| 브랜치 | 네임스페이스 | Secret 접미사 | 용도 |
|--------|------------|-------------|------|
| **main** | devops | -main | 운영 (Production) |
| **qa** | devops (또는 devops-qa) | -qa | QA 테스트 |
| **dev** | devops-dev | -dev | 개발 |

**환경별 차이**
• **로컬**: SQLite, localhost, .env 파일, mock Dify 가능
• **개발(dev)**: 별도 Dify/RAG, devops-dev NS, 개발자용 도메인
• **운영(main)**: 공용 Dify·RAG·DB, 공식 도메인, TLS

**설정 관리 전략**
• Secret: 브랜치별 다른 이름 → 같은 매니페스트로 다른 값 주입
• 환경변수: DIFY_BASE_URL, DIFY_API_KEY 등 환경별로 다르게 설정
• Ingress: 환경별 호스트 또는 경로로 구분

---

## 발표 노트

K8s 환경에서는 브랜치와 네임스페이스를 매핑합니다. main 브랜치는 운영 환경 devops 네임스페이스로 가고, qa 브랜치는 QA용 devops 또는 devops-qa로, dev 브랜치는 개발용 devops-dev로 배포합니다. Secret 이름도 브랜치마다 다르게 - main, -qa, -dev 이렇게 접미사가 붙습니다. 그래서 같은 매니페스트 파일을 쓰더라도, CI 스크립트에서 브랜치를 읽어서 다른 Secret을 참조하도록 할 수 있습니다.

환경별 차이를 보면, 로컬에서는 SQLite를 쓰고 localhost로 접속하며, .env 파일로 설정을 관리합니다. Dify가 없으면 mock 모드로 테스트할 수도 있습니다. 개발 환경에서는 별도의 Dify와 RAG 인스턴스를 써서 개발자들끼리 독립적으로 작업합니다. devops-dev 네임스페이스에 배포되고, 개발자용 도메인을 씁니다. 운영 환경에서는 공용 Dify, RAG, DB를 쓰고 공식 도메인으로 제공하며 TLS를 적용합니다.

설정 관리를 효과적으로 하려면, 브랜치마다 다른 Secret 이름을 두되, 같은 매니페스트 파일은 재사용합니다. CI 스크립트가 브랜치를 보고 Secret 이름을 동적으로 선택하게 하는 거죠. DIFY_BASE_URL이나 DIFY_API_KEY 같은 환경변수도 환경별로 다르게 설정합니다. Ingress도 환경마다 다른 호스트를 쓰거나 경로로 구분할 수 있습니다. 이렇게 하면 운영이 훨씬 깔끔합니다.
