# 02. 시크릿 갱신과 재시작

## Secret 변경 시

- **RAG Ingestion Secret**(MinIO, API Key): 변경 후 **RAG Backend** Pod를 재시작해야 새 값이 반영됩니다.  
  `kubectl rollout restart deployment/rag-backend deployment/rag-backend-drillquiz -n rag`
- **Ingestion Job/CronJob**: 다음 실행부터 새 Secret을 읽습니다. 이미 돌아가는 Job은 기동 시점의 Secret을 사용합니다.
- **chat-admin / chat-gateway**: DB 비밀번호·Dify API Key·JWT Secret 등을 바꾼 경우 해당 Deployment 재시작  
  `kubectl rollout restart deployment/chat-admin deployment/chat-gateway -n devops`

## 안전한 갱신 순서

1. Secret을 새 값으로 `kubectl apply` 또는 `kubectl create secret ... --dry-run=client -o yaml | kubectl apply -f -`
2. 해당 Secret을 참조하는 Deployment를 `rollout restart`
3. Pod가 새로 뜨는지 확인: `kubectl get pods -n <ns> -w`
4. 로그로 기동·연결 오류가 없는지 확인
